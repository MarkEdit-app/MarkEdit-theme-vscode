"use strict";const z=require("@codemirror/state"),t=require("@lezer/highlight"),m=require("markedit-api"),P=require("@codemirror/view"),k=require("@codemirror/language"),v=(s,r={})=>s??r,U=v(m.MarkEdit.userSettings),S=v(U["extension.markeditTheming"]),W=S.enabledMode??"both",_=v(S.lightTheme),q=v(S.darkTheme),I=s=>["both",s?"dark":"light"].includes(W),J=O(_),Q=O(q,{dark:!0});function X(s,r){if(!I(s))return r;const e=s?Q:J;return e===void 0?r:[e,r].filter(a=>a!==void 0)}function Y(s,r){if(!I(s))return r;const e=s?q.custom:_.custom;return e===void 0?r:{...r,...e}}function O(s,r){const e={},a=[],c=s.editor,o=s.highlight;return c?.textColor&&(e["&"]??={},e["&"].color=c?.textColor,e[".cm-activeLineGutter"]={backgroundColor:c?.textColor}),c?.backgroundColor&&(e["&"]??={},e["&"].backgroundColor=c?.backgroundColor),c?.activeLineBackground&&(e[".cm-activeLine"]={backgroundColor:c?.activeLineBackground}),c?.caretColor&&(e[".cm-content"]={caretColor:c?.caretColor},e[".cm-cursor, .cm-dropCursor"]={borderLeftColor:c?.caretColor}),c?.selectionBackground&&(e["&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection"]={backgroundColor:c?.selectionBackground}),c?.matchingBracketBackground&&(e["&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket"]={backgroundColor:c?.matchingBracketBackground}),c?.gutterText&&(e[".cm-gutters"]??={},e[".cm-gutters"].color=c?.gutterText),c?.gutterBackground&&(e[".cm-gutters"]??={},e[".cm-gutters"].backgroundColor=c?.gutterBackground,e[".cm-gutters"].border="none"),c?.foldPlaceholderText&&(e[".cm-foldPlaceholder"]??={},e[".cm-foldPlaceholder"].color=c?.foldPlaceholderText),c?.foldPlaceholderBackground&&(e[".cm-foldPlaceholder"]??={},e[".cm-foldPlaceholder"].backgroundColor=c?.foldPlaceholderBackground,e[".cm-foldPlaceholder"].border="none"),c?.searchMatchBackground&&(e[".cm-searchMatch"]={backgroundColor:c?.searchMatchBackground}),c?.selectionMatchBackground&&(e[".cm-selectionMatch"]={backgroundColor:c?.selectionMatchBackground}),o?.heading&&a.push({tag:t.tags.heading,color:o?.heading}),o?.bold&&a.push({tag:t.tags.strong,color:o?.bold}),o?.italic&&a.push({tag:t.tags.emphasis,color:o?.italic}),o?.strikethrough&&a.push({tag:t.tags.strikethrough,color:o?.strikethrough}),o?.quote&&a.push({tag:t.tags.quote,color:o?.quote}),o?.link&&a.push({tag:t.tags.link,color:o?.link}),o?.separator&&a.push({tag:[t.tags.definition(t.tags.name),t.tags.separator,t.tags.contentSeparator],color:o?.separator}),o?.comment&&a.push({tag:[t.tags.meta,t.tags.comment],color:o?.comment}),o?.meta&&a.push({tag:t.tags.meta,color:o?.meta}),o?.keyword&&a.push({tag:t.tags.keyword,color:o?.keyword}),o?.atom&&a.push({tag:[t.tags.atom,t.tags.bool,t.tags.url,t.tags.contentSeparator,t.tags.labelName],color:o?.atom}),o?.literal&&a.push({tag:[t.tags.literal,t.tags.inserted],color:o?.literal}),o?.string&&a.push({tag:[t.tags.string,t.tags.deleted],color:o?.string}),o?.special&&a.push({tag:[t.tags.regexp,t.tags.escape,t.tags.special(t.tags.string)],color:o?.special}),o?.variable&&a.push({tag:t.tags.definition(t.tags.variableName),color:o?.variable}),o?.local&&a.push({tag:t.tags.local(t.tags.variableName),color:o?.local}),o?.type&&a.push({tag:[t.tags.typeName,t.tags.namespace],color:o?.type}),o?.class&&a.push({tag:t.tags.className,color:o?.class}),o?.macro&&a.push({tag:[t.tags.special(t.tags.variableName),t.tags.macroName],color:o?.macro}),o?.property&&a.push({tag:t.tags.definition(t.tags.propertyName),color:o?.property}),o?.label&&a.push({tag:t.tags.labelName,color:o?.label}),o?.operator&&a.push({tag:[t.tags.operator,t.tags.operatorKeyword],color:o?.operator}),o?.constant&&a.push({tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:o?.constant}),o?.instruction&&a.push({tag:t.tags.processingInstruction,color:o?.instruction}),o?.invalid&&a.push({tag:t.tags.invalid,color:o?.invalid}),[P.EditorView.theme(e,r),k.syntaxHighlighting(k.HighlightStyle.define(a))]}const n={selectionBackground:".cm-selectionBackground",lineGutter:".cm-lineNumbers > .cm-activeLineGutter",foldGutter:".cm-foldGutter, .cm-foldPlaceholder",visibleSpace:".cm-visibleSpace, .cm-visibleSpace::before, .cm-visibleLineBreak, .cm-visibleLineBreak::before",matchingBracket:".cm-matchingBracket",activeIndicator:".cm-md-activeIndicator",emphasisElement:".cm-md-bold:not(.tok-meta), .cm-md-italic:not(.tok-meta), .cm-md-quote:not(.cm-md-quoteMark)",accentColor:".cm-md-header:not(.tok-meta):not(.cm-md-quote), .cm-md-codeInfo",syntaxMarker:".cm-md-header.tok-meta:not(.cm-md-quote), .cm-md-codeMark, .cm-md-linkMark, .cm-md-listMark, .cm-md-quoteMark"},Z=`
.cm-activeLineGutter { background: inherit !important }
.cm-searchMatch.cm-searchMatch-selected { outline: inherit !important }
${n.lineGutter} {}
${n.foldGutter} {}
${n.visibleSpace} {}
${n.matchingBracket} {}
${n.activeIndicator} {}
${n.emphasisElement} {}
${n.accentColor} {}
${n.syntaxMarker} {}
`,H=window,tt=H.__extractStyleRules__??(s=>s.value?.rules),et=H.__extractHighlightSpecs__??(s=>s.value?.specs);function ot(s){const r=document.createElement("style");return r.textContent=s,document.head.appendChild(r),r}function at(s){if(s===void 0)return[{},[]];const r=ct(s);return[Object.fromEntries(r.flatMap(a=>{const c=tt(a)?.join(`
`)??"";return Object.entries(st(c))})),r.flatMap(a=>et(a)??[])]}function L(s,r){return s.find(e=>!!(e.tag.toString().includes(r.toString())&&e.color!==void 0))?.color}function B(s,r,e){for(const[a,c]of Object.entries(s))if(a.includes(r)&&(e===void 0||!a.includes(e))){const o=c.background??c.backgroundColor;if(o!==void 0)return o}}function rt(s){const r=s.match(/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/);if(r===null)return;const[e,a,c]=r.slice(1,4).map(Number);return`rgba(${e}, ${a}, ${c}, 0.6)`}function ct(s){const r=[],e=[s];for(;e.length>0;){const a=e.pop();Array.isArray(a)?a.forEach(c=>e.push(c)):"extension"in a?e.push(a.extension):r.push(a)}return r}function st(s){const r={},e=new CSSStyleSheet;e.replaceSync(s);for(const a of e.cssRules){const{style:c,selectorText:o}=a,{background:l,backgroundColor:d}=c;r[o]={},l.length>0&&(r[o].background=l),d.length>0&&(r[o].backgroundColor=d)}return r}function nt(s){s.light!==void 0&&(i().customThemes.light=s.light),s.dark!==void 0&&(i().customThemes.dark=s.dark),typeof m.MarkEdit.editorView=="object"&&M(m.MarkEdit.editorView)}const p=window,i=()=>p.__markeditTheming__,F=matchMedia("(prefers-color-scheme: dark)");typeof i()!="object"&&it();function it(){p.__markeditTheming__={styleSheet:ot(Z),configurator:new z.Compartment,customThemes:{},lightOriginalRules:{},darkOriginalRules:{}},m.MarkEdit.addExtension(i().configurator.of([])),m.MarkEdit.onEditorReady(r=>M(r));const s=()=>setTimeout(()=>M(m.MarkEdit.editorView),15);F.addEventListener("change",s),i().mainThemeName=p.config.theme,Object.defineProperty(p.config,"theme",{get(){return i().mainThemeName},set(r){i().mainThemeName=r,s()}})}function M(s){const r=F.matches,e=r?i().customThemes.dark:i().customThemes.light,a=X(r,e?.extension),c=Y(r,e?.colors);s.dispatch({effects:i().configurator.reconfigure(a??[])});const[o,l]=at(a),d=a===void 0;i().styleSheet.disabled=d,gt(s,r,d,o,l,c)}function gt(s,r,e,a,c,o){const l=B(a,".cm-activeLine",".cm-activeLineGutter"),d=B(a,n.selectionBackground),y=B(a,n.matchingBracket),f=getComputedStyle(s.contentDOM).color,N=o?.visibleSpace??rt(f),j=L(c,t.tags.heading)!==void 0,R=L(c,t.tags.processingInstruction),A=[[n.activeIndicator,l,"background"],[n.matchingBracket,y,"background"],[n.lineGutter,f,"color"],[n.foldGutter,N,"color"],[n.visibleSpace,N,"color"],[n.accentColor,o?.accentColor,"color"],[n.syntaxMarker,R??o?.syntaxMarker,"color"]],V=Array.from(document.querySelectorAll("style")),h=r?i().darkOriginalRules:i().lightOriginalRules;for(const D of V){const C=D.sheet?.cssRules;if(C!==void 0)for(let x=0;x<C.length;++x){const g=C[x],u=g.selectorText??"";u.includes(".cm-focused")&&u.includes(n.selectionBackground)&&(h.selectionBackground??=g.cssText,e?g.cssText=h.selectionBackground:d!==void 0&&g.style.setProperty("background",d,"important")),j&&(u===".cm-md-header"||u===".cm-md-header:not(.cm-md-quote)")&&(h.markdownHeader??=g.cssText,e?g.cssText=h.markdownHeader:g.style.removeProperty("color"));for(const[K,T,w]of A)u===K&&(T===void 0?g.style.removeProperty(w):(g.style.setProperty(w,T,"important"),(u===n.matchingBracket||u===n.activeIndicator)&&g.style.setProperty("box-shadow","unset","important")));u===n.emphasisElement&&(o?.subtleEmphasis??!0?g.style.setProperty("color","inherit","important"):g.style.removeProperty("color"))}}}function b(){return b=Object.assign?Object.assign.bind():function(s){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var a in e)({}).hasOwnProperty.call(e,a)&&(s[a]=e[a])}return s},b.apply(null,arguments)}var G=s=>{var{theme:r,settings:e={},styles:a=[]}=s,c={".cm-gutters":{}},o={};e.background&&(o.backgroundColor=e.background),e.backgroundImage&&(o.backgroundImage=e.backgroundImage),e.foreground&&(o.color=e.foreground),e.fontSize&&(o.fontSize=e.fontSize),(e.background||e.foreground)&&(c["&"]=o),e.fontFamily&&(c["&.cm-editor .cm-scroller"]={fontFamily:e.fontFamily}),e.gutterBackground&&(c[".cm-gutters"].backgroundColor=e.gutterBackground),e.gutterForeground&&(c[".cm-gutters"].color=e.gutterForeground),e.gutterBorder&&(c[".cm-gutters"].borderRightColor=e.gutterBorder),e.caret&&(c[".cm-content"]={caretColor:e.caret},c[".cm-cursor, .cm-dropCursor"]={borderLeftColor:e.caret});var l={};e.gutterActiveForeground&&(l.color=e.gutterActiveForeground),e.lineHighlight&&(c[".cm-activeLine"]={backgroundColor:e.lineHighlight},l.backgroundColor=e.lineHighlight),c[".cm-activeLineGutter"]=l,e.selection&&(c["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:e.selection+" !important"}),e.selectionMatch&&(c["& .cm-selectionMatch"]={backgroundColor:e.selectionMatch});var d=P.EditorView.theme(c,{dark:r==="dark"}),y=k.HighlightStyle.define(a),f=[d,k.syntaxHighlighting(y)];return f},lt={background:"#ffffff",foreground:"#383a42",caret:"#000",selection:"#add6ff",selectionMatch:"#a8ac94",lineHighlight:"#99999926",gutterBackground:"#fff",gutterForeground:"#237893",gutterActiveForeground:"#0b216f",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},dt=[{tag:[t.tags.keyword,t.tags.operatorKeyword,t.tags.modifier,t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name),t.tags.standard(t.tags.tagName),t.tags.special(t.tags.brace),t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:"#0000ff"},{tag:[t.tags.moduleKeyword,t.tags.controlKeyword],color:"#af00db"},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.macroName,t.tags.propertyName,t.tags.variableName,t.tags.labelName,t.tags.definition(t.tags.name)],color:"#0070c1"},{tag:t.tags.heading,fontWeight:"bold",color:"#0070c1"},{tag:[t.tags.typeName,t.tags.className,t.tags.tagName,t.tags.number,t.tags.changed,t.tags.annotation,t.tags.self,t.tags.namespace],color:"#267f99"},{tag:[t.tags.function(t.tags.variableName),t.tags.function(t.tags.propertyName)],color:"#795e26"},{tag:[t.tags.number],color:"#098658"},{tag:[t.tags.operator,t.tags.punctuation,t.tags.separator,t.tags.url,t.tags.escape,t.tags.regexp],color:"#383a42"},{tag:[t.tags.regexp],color:"#af00db"},{tag:[t.tags.special(t.tags.string),t.tags.processingInstruction,t.tags.string,t.tags.inserted],color:"#a31515"},{tag:[t.tags.angleBracket],color:"#383a42"},{tag:t.tags.strong,fontWeight:"bold"},{tag:t.tags.emphasis,fontStyle:"italic"},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:[t.tags.meta,t.tags.comment],color:"#008000"},{tag:t.tags.link,color:"#4078f2",textDecoration:"underline"},{tag:t.tags.invalid,color:"#e45649"}];function ut(s){var{theme:r="light",settings:e={},styles:a=[]}={};return G({theme:r,settings:b({},lt,e),styles:[...dt,...a]})}var mt=ut(),ft={background:"#1e1e1e",foreground:"#9cdcfe",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"#ffffff0f",gutterBackground:"#1e1e1e",gutterForeground:"#838383",gutterActiveForeground:"#fff",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},ht=[{tag:[t.tags.keyword,t.tags.operatorKeyword,t.tags.modifier,t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name),t.tags.standard(t.tags.tagName),t.tags.special(t.tags.brace),t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:"#569cd6"},{tag:[t.tags.controlKeyword,t.tags.moduleKeyword],color:"#c586c0"},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.macroName,t.tags.propertyName,t.tags.variableName,t.tags.labelName,t.tags.definition(t.tags.name)],color:"#9cdcfe"},{tag:t.tags.heading,fontWeight:"bold",color:"#9cdcfe"},{tag:[t.tags.typeName,t.tags.className,t.tags.tagName,t.tags.number,t.tags.changed,t.tags.annotation,t.tags.self,t.tags.namespace],color:"#4ec9b0"},{tag:[t.tags.function(t.tags.variableName),t.tags.function(t.tags.propertyName)],color:"#dcdcaa"},{tag:[t.tags.number],color:"#b5cea8"},{tag:[t.tags.operator,t.tags.punctuation,t.tags.separator,t.tags.url,t.tags.escape,t.tags.regexp],color:"#d4d4d4"},{tag:[t.tags.regexp],color:"#d16969"},{tag:[t.tags.special(t.tags.string),t.tags.processingInstruction,t.tags.string,t.tags.inserted],color:"#ce9178"},{tag:[t.tags.angleBracket],color:"#808080"},{tag:t.tags.strong,fontWeight:"bold"},{tag:t.tags.emphasis,fontStyle:"italic"},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:[t.tags.meta,t.tags.comment],color:"#6a9955"},{tag:t.tags.link,color:"#6a9955",textDecoration:"underline"},{tag:t.tags.invalid,color:"#ff0000"}];function pt(s){var{theme:r="dark",settings:e={},styles:a=[]}={};return G({theme:r,settings:b({},ft,e),styles:[...ht,...a]})}var kt=pt();const $=(s,r={})=>s??r,bt=$($(m.MarkEdit.userSettings)["extension.markeditThemeVSCode"]),E=bt.enabledMode??"both",vt={extension:mt},yt={extension:kt};nt({light:["both","light"].includes(E)?vt:void 0,dark:["both","dark"].includes(E)?yt:void 0});
