"use strict";const W=require("@codemirror/state"),t=require("@lezer/highlight"),m=require("markedit-api"),$=require("@codemirror/view"),k=require("@codemirror/language"),v=(a,n={})=>a??n,z=v(m.MarkEdit.userSettings),T=q("extension.markeditTheming"),J=b(!1)?v(T.lightTheme):void 0,Q=b(!0)?v(T.darkTheme):void 0;function q(a){return a===void 0?{}:v(z[a])}function I(a){return a.enabledMode??"both"}function b(a,n=I(T)){return["both",a?"dark":"light"].includes(n)}function X(a,n,e){const s=Y({lhs:e,rhs:a?Q:J});return{extensions:[...a?O(s,{dark:!0}):O(s),n].filter(o=>o!==void 0),colors:s}}function O(a,n){const e={},s=[],r=a.editor,o=a.highlight;r?.textColor&&(e["&"]??={},e["&"].color=r?.textColor,e[".cm-activeLineGutter"]={backgroundColor:r?.textColor}),r?.backgroundColor&&(e["&"]??={},e["&"].backgroundColor=r?.backgroundColor),r?.activeLineBackground&&(e[".cm-activeLine"]={backgroundColor:r?.activeLineBackground}),r?.caretColor&&(e[".cm-content"]={caretColor:r?.caretColor},e[".cm-cursor, .cm-dropCursor"]={borderLeftColor:r?.caretColor}),r?.selectionBackground&&(e["&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection"]={backgroundColor:r?.selectionBackground}),r?.matchingBracketBackground&&(e["&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket"]={backgroundColor:r?.matchingBracketBackground}),r?.gutterText&&(e[".cm-gutters"]??={},e[".cm-gutters"].color=r?.gutterText),r?.gutterBackground&&(e[".cm-gutters"]??={},e[".cm-gutters"].backgroundColor=r?.gutterBackground,e[".cm-gutters"].border="none"),r?.foldPlaceholderText&&(e[".cm-foldPlaceholder"]??={},e[".cm-foldPlaceholder"].color=r?.foldPlaceholderText),r?.foldPlaceholderBackground&&(e[".cm-foldPlaceholder"]??={},e[".cm-foldPlaceholder"].backgroundColor=r?.foldPlaceholderBackground,e[".cm-foldPlaceholder"].border="none"),r?.searchMatchBackground&&(e[".cm-searchMatch"]={backgroundColor:r?.searchMatchBackground}),r?.selectionMatchBackground&&(e[".cm-selectionMatch"]={backgroundColor:r?.selectionMatchBackground}),o?.heading&&s.push({tag:t.tags.heading,color:o?.heading}),o?.bold&&s.push({tag:t.tags.strong,color:o?.bold}),o?.italic&&s.push({tag:t.tags.emphasis,color:o?.italic}),o?.strikethrough&&s.push({tag:t.tags.strikethrough,color:o?.strikethrough}),o?.quote&&s.push({tag:t.tags.quote,color:o?.quote}),o?.link&&s.push({tag:[t.tags.url,t.tags.link],color:o?.link}),o?.separator&&s.push({tag:[t.tags.definition(t.tags.name),t.tags.separator,t.tags.contentSeparator],color:o?.separator}),o?.comment&&s.push({tag:t.tags.comment,color:o?.comment}),o?.meta&&s.push({tag:t.tags.meta,color:o?.meta}),o?.keyword&&s.push({tag:t.tags.keyword,color:o?.keyword}),o?.atom&&s.push({tag:[t.tags.atom,t.tags.bool],color:o?.atom}),o?.literal&&s.push({tag:[t.tags.literal,t.tags.inserted],color:o?.literal}),o?.string&&s.push({tag:[t.tags.string,t.tags.deleted],color:o?.string}),o?.special&&s.push({tag:[t.tags.regexp,t.tags.escape,t.tags.special(t.tags.string)],color:o?.special}),o?.variable&&s.push({tag:t.tags.definition(t.tags.variableName),color:o?.variable}),o?.local&&s.push({tag:t.tags.local(t.tags.variableName),color:o?.local}),o?.type&&s.push({tag:[t.tags.typeName,t.tags.namespace],color:o?.type}),o?.class&&s.push({tag:t.tags.className,color:o?.class}),o?.macro&&s.push({tag:[t.tags.special(t.tags.variableName),t.tags.macroName],color:o?.macro}),o?.property&&s.push({tag:t.tags.definition(t.tags.propertyName),color:o?.property}),o?.label&&s.push({tag:t.tags.labelName,color:o?.label}),o?.operator&&s.push({tag:[t.tags.operator,t.tags.operatorKeyword],color:o?.operator}),o?.constant&&s.push({tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:o?.constant}),o?.instruction&&s.push({tag:t.tags.processingInstruction,color:o?.instruction}),o?.invalid&&s.push({tag:t.tags.invalid,color:o?.invalid});const i=[];return Object.keys(e).length>0&&i.push($.EditorView.theme(e,n)),s.length>0&&i.push(k.syntaxHighlighting(k.HighlightStyle.define(s))),i}function Y(a){return{editor:{...a.lhs?.editor,...a.rhs?.editor},highlight:{...a.lhs?.highlight,...a.rhs?.highlight},subtleEmphasis:a.rhs?.subtleEmphasis??a.lhs?.subtleEmphasis}}const c={selectionBackground:".cm-selectionBackground",lineGutter:".cm-lineNumbers > .cm-activeLineGutter",foldGutter:".cm-foldGutter, .cm-foldPlaceholder",visibleSpace:".cm-visibleSpace, .cm-visibleSpace::before, .cm-visibleLineBreak, .cm-visibleLineBreak::before",matchingBracket:".cm-matchingBracket",activeIndicator:".cm-md-activeIndicator",emphasisElement:".cm-md-bold:not(.tok-meta), .cm-md-italic:not(.tok-meta), .cm-md-quote:not(.cm-md-quoteMark)",accentColor:".cm-md-header:not(.tok-meta):not(.cm-md-quote), .cm-md-codeInfo",syntaxMarker:".cm-md-header.tok-meta:not(.cm-md-quote), .cm-md-codeMark, .cm-md-linkMark, .cm-md-listMark, .cm-md-quoteMark"},Z=`
.cm-activeLineGutter { background: inherit !important }
.cm-searchMatch.cm-searchMatch-selected { outline: inherit !important }
${c.lineGutter} {}
${c.foldGutter} {}
${c.visibleSpace} {}
${c.matchingBracket} {}
${c.activeIndicator} {}
${c.emphasisElement} {}
${c.accentColor} {}
${c.syntaxMarker} {}
`,j=window,tt=j.__extractStyleRules__??(a=>a.value?.rules),et=j.__extractHighlightSpecs__??(a=>a.value?.specs);function ot(a){const n=document.createElement("style");return n.textContent=a,document.head.appendChild(n),n}function at(a){if(a.length===0)return[{},[]];const n=S(a);return[Object.fromEntries(n.flatMap(s=>{const r=tt(s)?.join(`
`)??"";return Object.entries(st(r))})),n.flatMap(s=>et(s)??[])]}function _(a,n){return a.find(e=>!!(e.tag.toString().includes(n.toString())&&e.color!==void 0))?.color}function M(a,n,e){for(const[s,r]of Object.entries(a))if(s.includes(n)&&(e===void 0||!s.includes(e))){const o=r.background??r.backgroundColor;if(o!==void 0)return o}}function rt(a){const n=a.match(/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/);if(n===null)return;const[e,s,r]=n.slice(1,4).map(Number);return`rgba(${e}, ${s}, ${r}, 0.6)`}function F(a){const n=r=>r!==null&&typeof r=="object";if(!n(a))return!0;const e=Object.entries(a),s=r=>r!=null;for(const[,r]of e)if(n(r)){if(!F(r))return!1}else if(s(r))return!1;return!0}function S(a){return Array.isArray(a)?a.flatMap(S):"extension"in a?S(a.extension):[a]}function st(a){const n={},e=new CSSStyleSheet;e.replaceSync(a);for(const s of e.cssRules){const{style:r,selectorText:o}=s,{background:i,backgroundColor:d}=r;n[o]={},i.length>0&&(n[o].background=i),d.length>0&&(n[o].backgroundColor=d)}return n}function nt(a){const n=a.options?.settingsKey,e=I(q(n));a.light!==void 0&&b(!1,e)&&(g().customThemes.light=a.light),a.dark!==void 0&&b(!0,e)&&(g().customThemes.dark=a.dark),typeof m.MarkEdit.editorView=="object"&&N(m.MarkEdit.editorView)}const p=window,g=()=>p.__markeditTheming__,G=matchMedia("(prefers-color-scheme: dark)");typeof g()!="object"&&ct();function ct(){p.__markeditTheming__={styleSheet:ot(Z),configurator:new W.Compartment,customThemes:{},lightOriginalRules:{},darkOriginalRules:{}},m.MarkEdit.addExtension(g().configurator.of([])),m.MarkEdit.onEditorReady(n=>N(n));const a=()=>setTimeout(()=>N(m.MarkEdit.editorView),15);G.addEventListener("change",a),g().mainThemeName=p.config.theme,Object.defineProperty(p.config,"theme",{get(){return g().mainThemeName},set(n){g().mainThemeName=n,a()}})}function N(a){const n=G.matches,e=n?g().customThemes.dark:g().customThemes.light,{extensions:s,colors:r}=X(n,e?.extension,e?.colors);a.dispatch({effects:g().configurator.reconfigure(s)});const[o,i]=at(s),d=s.length===0&&F(r);g().styleSheet.disabled=d,it(a,n,d,o,i,r)}function it(a,n,e,s,r,o){const i=M(s,".cm-activeLine",".cm-activeLineGutter"),d=M(s,c.selectionBackground),C=M(s,c.matchingBracket),h=getComputedStyle(a.contentDOM).color,w=o.editor?.visibleSpaceColor??rt(h),E=_(r,t.tags.heading),R=_(r,t.tags.processingInstruction),A=[[c.activeIndicator,i,"background"],[c.matchingBracket,C,"background"],[c.lineGutter,h,"color"],[c.foldGutter,w,"color"],[c.visibleSpace,w,"color"],[c.accentColor,E,"color"],[c.syntaxMarker,R,"color"]],V=Array.from(document.querySelectorAll("style")),f=n?g().darkOriginalRules:g().lightOriginalRules;for(const K of V){const x=K.sheet?.cssRules;if(x!==void 0)for(let B=0;B<x.length;++B){const l=x[B],u=l.selectorText??"";u.includes(".cm-focused")&&u.includes(c.selectionBackground)&&(f.selectionBackground??=l.cssText,e?l.cssText=f.selectionBackground:d!==void 0&&l.style.setProperty("background",d,"important")),E!==void 0&&(u===".cm-md-header"||u===".cm-md-header:not(.cm-md-quote)")&&(f.markdownHeader??=l.cssText,e?l.cssText=f.markdownHeader:l.style.removeProperty("color"));for(const[D,L,P]of A)if(u===D)if(L===void 0)l.style.removeProperty(P);else{const U=[c.accentColor,c.syntaxMarker].includes(u)?void 0:"important";l.style.setProperty(P,L,U),(u===c.matchingBracket||u===c.activeIndicator)&&l.style.setProperty("box-shadow","unset","important")}u===c.emphasisElement&&(o.subtleEmphasis??!0?l.style.setProperty("color","inherit","important"):l.style.removeProperty("color"))}}}function y(){return y=Object.assign?Object.assign.bind():function(a){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var s in e)({}).hasOwnProperty.call(e,s)&&(a[s]=e[s])}return a},y.apply(null,arguments)}var H=a=>{var{theme:n,settings:e={},styles:s=[]}=a,r={".cm-gutters":{}},o={};e.background&&(o.backgroundColor=e.background),e.backgroundImage&&(o.backgroundImage=e.backgroundImage),e.foreground&&(o.color=e.foreground),e.fontSize&&(o.fontSize=e.fontSize),(e.background||e.foreground)&&(r["&"]=o),e.fontFamily&&(r["&.cm-editor .cm-scroller"]={fontFamily:e.fontFamily}),e.gutterBackground&&(r[".cm-gutters"].backgroundColor=e.gutterBackground),e.gutterForeground&&(r[".cm-gutters"].color=e.gutterForeground),e.gutterBorder&&(r[".cm-gutters"].borderRightColor=e.gutterBorder),e.caret&&(r[".cm-content"]={caretColor:e.caret},r[".cm-cursor, .cm-dropCursor"]={borderLeftColor:e.caret});var i={};e.gutterActiveForeground&&(i.color=e.gutterActiveForeground),e.lineHighlight&&(r[".cm-activeLine"]={backgroundColor:e.lineHighlight},i.backgroundColor=e.lineHighlight),r[".cm-activeLineGutter"]=i,e.selection&&(r["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:e.selection+" !important"}),e.selectionMatch&&(r["& .cm-selectionMatch"]={backgroundColor:e.selectionMatch});var d=$.EditorView.theme(r,{dark:n==="dark"}),C=k.HighlightStyle.define(s),h=[d,k.syntaxHighlighting(C)];return h},gt={background:"#ffffff",foreground:"#383a42",caret:"#000",selection:"#add6ff",selectionMatch:"#a8ac94",lineHighlight:"#99999926",gutterBackground:"#fff",gutterForeground:"#237893",gutterActiveForeground:"#0b216f",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},lt=[{tag:[t.tags.keyword,t.tags.operatorKeyword,t.tags.modifier,t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name),t.tags.standard(t.tags.tagName),t.tags.special(t.tags.brace),t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:"#0000ff"},{tag:[t.tags.moduleKeyword,t.tags.controlKeyword],color:"#af00db"},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.macroName,t.tags.propertyName,t.tags.variableName,t.tags.labelName,t.tags.definition(t.tags.name)],color:"#0070c1"},{tag:t.tags.heading,fontWeight:"bold",color:"#0070c1"},{tag:[t.tags.typeName,t.tags.className,t.tags.tagName,t.tags.number,t.tags.changed,t.tags.annotation,t.tags.self,t.tags.namespace],color:"#267f99"},{tag:[t.tags.function(t.tags.variableName),t.tags.function(t.tags.propertyName)],color:"#795e26"},{tag:[t.tags.number],color:"#098658"},{tag:[t.tags.operator,t.tags.punctuation,t.tags.separator,t.tags.url,t.tags.escape,t.tags.regexp],color:"#383a42"},{tag:[t.tags.regexp],color:"#af00db"},{tag:[t.tags.special(t.tags.string),t.tags.processingInstruction,t.tags.string,t.tags.inserted],color:"#a31515"},{tag:[t.tags.angleBracket],color:"#383a42"},{tag:t.tags.strong,fontWeight:"bold"},{tag:t.tags.emphasis,fontStyle:"italic"},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:[t.tags.meta,t.tags.comment],color:"#008000"},{tag:t.tags.link,color:"#4078f2",textDecoration:"underline"},{tag:t.tags.invalid,color:"#e45649"}];function dt(a){var{theme:n="light",settings:e={},styles:s=[]}={};return H({theme:n,settings:y({},gt,e),styles:[...lt,...s]})}var ut=dt(),mt={background:"#1e1e1e",foreground:"#9cdcfe",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"#ffffff0f",gutterBackground:"#1e1e1e",gutterForeground:"#838383",gutterActiveForeground:"#fff",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},ht=[{tag:[t.tags.keyword,t.tags.operatorKeyword,t.tags.modifier,t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name),t.tags.standard(t.tags.tagName),t.tags.special(t.tags.brace),t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:"#569cd6"},{tag:[t.tags.controlKeyword,t.tags.moduleKeyword],color:"#c586c0"},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.macroName,t.tags.propertyName,t.tags.variableName,t.tags.labelName,t.tags.definition(t.tags.name)],color:"#9cdcfe"},{tag:t.tags.heading,fontWeight:"bold",color:"#9cdcfe"},{tag:[t.tags.typeName,t.tags.className,t.tags.tagName,t.tags.number,t.tags.changed,t.tags.annotation,t.tags.self,t.tags.namespace],color:"#4ec9b0"},{tag:[t.tags.function(t.tags.variableName),t.tags.function(t.tags.propertyName)],color:"#dcdcaa"},{tag:[t.tags.number],color:"#b5cea8"},{tag:[t.tags.operator,t.tags.punctuation,t.tags.separator,t.tags.url,t.tags.escape,t.tags.regexp],color:"#d4d4d4"},{tag:[t.tags.regexp],color:"#d16969"},{tag:[t.tags.special(t.tags.string),t.tags.processingInstruction,t.tags.string,t.tags.inserted],color:"#ce9178"},{tag:[t.tags.angleBracket],color:"#808080"},{tag:t.tags.strong,fontWeight:"bold"},{tag:t.tags.emphasis,fontStyle:"italic"},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:[t.tags.meta,t.tags.comment],color:"#6a9955"},{tag:t.tags.link,color:"#6a9955",textDecoration:"underline"},{tag:t.tags.invalid,color:"#ff0000"}];function ft(a){var{theme:n="dark",settings:e={},styles:s=[]}={};return H({theme:n,settings:y({},mt,e),styles:[...ht,...s]})}var pt=ft();nt({light:{extension:ut},dark:{extension:pt},options:{settingsKey:"extension.markeditThemeVSCode"}});
